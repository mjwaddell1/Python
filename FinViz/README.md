
This script scrapes Finviz and returns the stock data as a dictionary. The stock filter can be set within the script.

The Finviz page has 2 sections to retrieve data:

Main table (ticker\name\price\change):
</thead>
<tr class="styled-row is-hoverable is-bordered is-rounded is-striped has-color-text" valign="top">
<td height="10" align="right"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" ">1</a></td><td height="10" align="left" data-boxover="cssbody=[hoverchart] cssheader=[tabchrthdr] body=[<img src='https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAON&tf=d&s=linear&ct=candle_stick&tm=d' srcset='https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAON&tf=d&s=linear&ct=candle_stick&tm=d 1x, https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAON&tf=d&s=linear&ct=candle_stick&tm=d&sf=2 2x' width='324' height='180' alt='' referrerPolicy='no-referrer-when-downgrade' loading='lazy'><div><b>AAON Inc.</b>Building Products & Equipment <span>•</span> USA <span>•</span> 5.18B</div>] offsetx=[100] offsety=[0] delay=[0]"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" class="tab-link">AAON</a></td><td height="10" align="left"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" ">AAON Inc.</a></td><td height="10" align="left"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" ">Industrials</a></td><td height="10" align="left"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" ">Building Products & Equipment</a></td><td height="10" align="left"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" ">USA</a></td><td height="10" align="right"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" ">5.18B</a></td><td height="10" align="right"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" ">31.23</a></td><td height="10" align="right" data-boxover="cssbody=[hoverchart] cssheader=[tabchrthdr] body=[<img src='https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAON&tf=d&s=linear&ct=candle_stick&tm=d' srcset='https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAON&tf=d&s=linear&ct=candle_stick&tm=d 1x, https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAON&tf=d&s=linear&ct=candle_stick&tm=d&sf=2 2x' width='324' height='180' alt='' referrerPolicy='no-referrer-when-downgrade' loading='lazy'><div><b>AAON Inc.</b>Building Products & Equipment <span>•</span> USA <span>•</span> 5.18B</div>] offsetx=[-324] offsety=[20] delay=[0]"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" "><span class="color-text is-negative">63.76</span></a></td><td height="10" align="right"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" "><span class="color-text is-negative">-0.47%</span></a></td><td height="10" align="right"><a href="quote.ashx?t=AAON&ty=c&p=d&b=1" ">467,918</a></td></tr><tr class="styled-row is-hoverable is-bordered is-rounded is-striped has-color-text" valign="top">
<td height="10" align="right"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" ">2</a></td><td height="10" align="left" data-boxover="cssbody=[hoverchart] cssheader=[tabchrthdr] body=[<img src='https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAP&tf=d&s=linear&ct=candle_stick&tm=d' srcset='https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAP&tf=d&s=linear&ct=candle_stick&tm=d 1x, https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAP&tf=d&s=linear&ct=candle_stick&tm=d&sf=2 2x' width='324' height='180' alt='' referrerPolicy='no-referrer-when-downgrade' loading='lazy'><div><b>Advance Auto Parts Inc</b>Specialty Retail <span>•</span> USA <span>•</span> 3.31B</div>] offsetx=[100] offsety=[0] delay=[0]"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" class="tab-link">AAP</a></td><td height="10" align="left"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" ">Advance Auto Parts Inc</a></td><td height="10" align="left"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" ">Consumer Cyclical</a></td><td height="10" align="left"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" ">Specialty Retail</a></td><td height="10" align="left"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" ">USA</a></td><td height="10" align="right"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" ">3.31B</a></td><td height="10" align="right"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" "><span class="color-text is-positive">9.64</span></a></td><td height="10" align="right" data-boxover="cssbody=[hoverchart] cssheader=[tabchrthdr] body=[<img src='https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAP&tf=d&s=linear&ct=candle_stick&tm=d' srcset='https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAP&tf=d&s=linear&ct=candle_stick&tm=d 1x, https://charts2-node.finviz.com/chart.ashx?cs=m&t=AAP&tf=d&s=linear&ct=candle_stick&tm=d&sf=2 2x' width='324' height='180' alt='' referrerPolicy='no-referrer-when-downgrade' loading='lazy'><div><b>Advance Auto Parts Inc</b>Specialty Retail <span>•</span> USA <span>•</span> 3.31B</div>] offsetx=[-324] offsety=[20] delay=[0]"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" "><span class="color-text is-negative">55.67</span></a></td><td height="10" align="right"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" "><span class="color-text is-negative">-4.67%</span></a></td><td height="10" align="right"><a href="quote.ashx?t=AAP&ty=c&p=d&b=1" ">8,421,273</a></td></tr><tr class="styled-row is-hoverable is-bordered is-rounded is-striped has-color-text" valign="top">
<td height="10" align="right"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" ">20</a></td><td height="10" align="left" data-boxover="cssbody=[hoverchart] cssheader=[tabchrthdr] body=[<img src='https://charts2-node.finviz.com/chart.ashx?cs=m&t=ANET&tf=d&s=linear&ct=candle_stick&tm=d' srcset='https://charts2-node.finviz.com/chart.ashx?cs=m&t=ANET&tf=d&s=linear&ct=candle_stick&tm=d 1x, https://charts2-node.finviz.com/chart.ashx?cs=m&t=ANET&tf=d&s=linear&ct=candle_stick&tm=d&sf=2 2x' width='324' height='180' alt='' referrerPolicy='no-referrer-when-downgrade' loading='lazy'><div><b>Arista Networks Inc</b>Computer Hardware <span>•</span> USA <span>•</span> 66.49B</div>] offsetx=[100] offsety=[-220] delay=[0]"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" class="tab-link">ANET</a></td><td height="10" align="left"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" ">Arista Networks Inc</a></td><td height="10" align="left"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" ">Technology</a></td><td height="10" align="left"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" ">Computer Hardware</a></td><td height="10" align="left"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" ">USA</a></td><td height="10" align="right"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" ">66.49B</a></td><td height="10" align="right"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" ">35.57</a></td><td height="10" align="right" data-boxover="cssbody=[hoverchart] cssheader=[tabchrthdr] body=[<img src='https://charts2-node.finviz.com/chart.ashx?cs=m&t=ANET&tf=d&s=linear&ct=candle_stick&tm=d' srcset='https://charts2-node.finviz.com/chart.ashx?cs=m&t=ANET&tf=d&s=linear&ct=candle_stick&tm=d 1x, https://charts2-node.finviz.com/chart.ashx?cs=m&t=ANET&tf=d&s=linear&ct=candle_stick&tm=d&sf=2 2x' width='324' height='180' alt='' referrerPolicy='no-referrer-when-downgrade' loading='lazy'><div><b>Arista Networks Inc</b>Computer Hardware <span>•</span> USA <span>•</span> 66.49B</div>] offsetx=[-324] offsety=[-264] delay=[0]"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" "><span class="color-text is-negative">213.74</span></a></td><td height="10" align="right"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" "><span class="color-text is-negative">-0.68%</span></a></td><td height="10" align="right"><a href="quote.ashx?t=ANET&ty=c&p=d&b=1" ">1,871,513</a></td></tr></table></td></tr></table>

Comment (ticker\price\volume):
<!-- TS
AAON|63.76|467918
AAP|55.67|8421273
ABG|222.74|142022
TE -->


To use these scripts, just copy the functions into your script.
